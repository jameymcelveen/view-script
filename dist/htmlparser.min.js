(function(){function g(a){var b={};a=a.split(",");for(var c=0;c<a.length;c++)b[a[c]]=!0;return b}var n=/^<([-A-Za-z0-9_]+)((?:\s+\w+(?:\s*=\s*(?:(?:"[^"]*")|(?:'[^']*')|[^>\s]+))?)*)\s*(\/?)>/,p=/^<\/([-A-Za-z0-9_]+)[^>]*>/,r=/([-A-Za-z0-9_]+)(?:\s*=\s*(?:(?:"((?:\\.|[^"])*)")|(?:'((?:\\.|[^'])*)')|([^>\s]+)))?/g,s=g("area,base,basefont,br,col,frame,hr,img,input,isindex,link,meta,param,embed"),t=g("address,applet,blockquote,button,center,dd,del,dir,div,dl,dt,fieldset,form,frameset,hr,iframe,ins,isindex,li,map,menu,noframes,noscript,object,ol,p,pre,script,table,tbody,td,tfoot,th,thead,tr,ul"),
u=g("a,abbr,acronym,applet,b,basefont,bdo,big,br,button,cite,code,del,dfn,em,font,i,iframe,img,input,ins,kbd,label,map,object,q,s,samp,script,select,small,span,strike,strong,sub,sup,textarea,tt,u,var"),v=g("colgroup,dd,dt,li,options,p,td,tfoot,th,thead,tr"),w=g("checked,compact,declare,defer,disabled,ismap,multiple,nohref,noresize,noshade,nowrap,readonly,selected"),x=g("script,style"),q=this.HTMLParser=function(a,b){function c(a,c,d,h){c=c.toLowerCase();if(t[c])for(;e.last()&&u[e.last()];)k("",e.last());
v[c]&&e.last()==c&&k("",c);(h=s[c]||!!h)||e.push(c);if(b.start){var f=[];d.replace(r,function(b,c,a,d,e){b=a?a:d?d:e?e:w[c]?c:"";f.push({name:c,value:b,escaped:b.replace(/(^|[^\\])"/g,'$1\\"')})});b.start&&b.start(c,f,h)}}function k(c,a){if(a)for(d=e.length-1;0<=d&&e[d]!=a;d--);else var d=0;if(0<=d){for(var h=e.length-1;h>=d;h--)b.end&&b.end(e[h]);e.length=d}}var d,f,e=[],h=a;for(e.last=function(){return this[this.length-1]};a;){f=!0;if(e.last()&&x[e.last()])a=a.replace(RegExp("(.*)</"+e.last()+"[^>]*>"),
function(a,c){c=c.replace(/\x3c!--(.*?)--\x3e/g,"$1").replace(/<!\[CDATA\[(.*?)]]\x3e/g,"$1");b.chars&&b.chars(c);return""}),k("",e.last());else{if(0==a.indexOf("\x3c!--"))d=a.indexOf("--\x3e"),0<=d&&(b.comment&&b.comment(a.substring(4,d)),a=a.substring(d+3),f=!1);else if(0==a.indexOf("</")){if(d=a.match(p))a=a.substring(d[0].length),d[0].replace(p,k),f=!1}else 0==a.indexOf("<")&&(d=a.match(n))&&(a=a.substring(d[0].length),d[0].replace(n,c),f=!1);f&&(d=a.indexOf("<"),f=0>d?a:a.substring(0,d),a=0>
d?"":a.substring(d),b.chars&&b.chars(f))}if(a==h)throw"Parse Error: "+a;h=a}k()};this.HTMLtoXML=function(a){var b="";q(a,{start:function(c,a,d){b+="<"+c;for(c=0;c<a.length;c++)b+=" "+a[c].name+'="'+a[c].escaped+'"';b+=(d?"/":"")+">"},end:function(a){b+="</"+a+">"},chars:function(a){b+=a},comment:function(a){b+="\x3c!--"+a+"--\x3e"}});return b};this.HTMLtoDOM=function(a,b){var c=g("html,head,body,title"),k={link:"head",base:"head"};b?b=b.ownerDocument||b.getOwnerDocument&&b.getOwnerDocument()||b:"undefined"!=
typeof DOMDocument?b=new DOMDocument:"undefined"!=typeof document&&document.implementation&&document.implementation.createDocument?b=document.implementation.createDocument("","",null):"undefined"!=typeof ActiveX&&(b=new ActiveXObject("Msxml.DOMDocument"));var d=[];b.documentElement||b.getDocumentElement&&b.getDocumentElement()||!b.createElement||function(){var a=b.createElement("html"),c=b.createElement("head");c.appendChild(b.createElement("title"));a.appendChild(c);a.appendChild(b.createElement("body"));
b.appendChild(a)}();if(b.getElementsByTagName)for(var f in c)c[f]=b.getElementsByTagName(f)[0];var e=c.body;q(a,{start:function(a,f,g){if(c[a])e=c[a],g||d.push(e);else{var l=b.createElement(a),m;for(m in f)l.setAttribute(f[m].name,f[m].value);k[a]&&"boolean"!=typeof c[k[a]]?c[k[a]].appendChild(l):e&&e.appendChild&&e.appendChild(l);g||(d.push(l),e=l)}},end:function(a){d.length-=1;e=d[d.length-1]},chars:function(a){e.appendChild(b.createTextNode(a))},comment:function(a){}});return b}})();
